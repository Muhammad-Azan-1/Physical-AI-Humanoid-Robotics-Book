"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[923],{111:(e,s,r)=>{r.r(s),r.d(s,{default:()=>u});var i=r(6540),n=r(351),t=r(8957),o=r(2777),a=r(9944),c=r(5915),l=r(4406),d=r(4848);const u=()=>{const[e,s]=(0,i.useState)("loading"),[r,u]=(0,i.useState)("Verifying your email..."),{siteConfig:g}=(0,o.A)();return(0,i.useEffect)(()=>{(async()=>{try{const e=g.customFields,r=e?.supabaseUrl||"",i=e?.supabaseAnonKey||"";if(!r||!i)return s("error"),void u("Authentication configuration is missing. Please contact support.");const n=(0,a.jB)({url:r,anonKey:i}),t=new URLSearchParams(window.location.hash.substring(1)),o=t.get("error"),l=t.get("error_description");if(o)return s("error"),void u(l||"An error occurred during email verification.");const d=t.get("access_token"),m=t.get("refresh_token"),h=t.get("type");if("recovery"===h&&d){s("success"),u("Password reset verified! Redirecting to set your new password...");const e=`${g.baseUrl}reset-password${window.location.hash}`;return void setTimeout(()=>{window.location.href=e},1500)}if(d&&m){const{data:e,error:r}=await n.auth.setSession({access_token:d,refresh_token:m});if(r)return s("error"),void u(r.message||"Failed to verify your session.");if(e.session){s("success"),u("Email verified successfully! You are now logged in.");const r={event:"SIGNED_IN",session:e.session,timestamp:Date.now()};localStorage.setItem("auth-state",JSON.stringify(r));const i=new URLSearchParams(window.location.search).get("returnUrl"),n=localStorage.getItem("original_destination");let t=g.baseUrl;return n?(t=(0,c.Og)(n,g.baseUrl),localStorage.removeItem("original_destination")):i&&(t=(0,c.Og)(decodeURIComponent(i),g.baseUrl)),void setTimeout(()=>{window.location.href=t},2e3)}}if("signup"===h||"email_change"===h){const{data:{session:e}}=await n.auth.getSession();if(e){s("success"),u("Email verified successfully! You are now logged in.");const r={event:"SIGNED_IN",session:e,timestamp:Date.now()};localStorage.setItem("auth-state",JSON.stringify(r));const i=new URLSearchParams(window.location.search).get("returnUrl"),n=localStorage.getItem("original_destination");let t=g.baseUrl;return n?(t=(0,c.Og)(n,g.baseUrl),localStorage.removeItem("original_destination")):i&&(t=(0,c.Og)(decodeURIComponent(i),g.baseUrl)),void setTimeout(()=>{window.location.href=t},2e3)}}const{data:{session:f}}=await n.auth.getSession();if(f){s("success"),u("You are already logged in! Redirecting...");const e=new URLSearchParams(window.location.search).get("returnUrl"),r=e?(0,c.Og)(decodeURIComponent(e),g.baseUrl):g.baseUrl;setTimeout(()=>{window.location.href=r},2e3)}else s("error"),u("Unable to verify your session. The link may have expired. Please try signing in.")}catch(e){console.error("Auth callback error:",e),s("error"),u(e.message||"An unexpected error occurred during authentication.")}})()},[g]),(0,d.jsx)(n.A,{title:"Email Verification",description:"Email verification callback",children:(0,d.jsx)("div",{className:"container margin-vert--xl",children:(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"col col--6 col--offset-3",children:(0,d.jsx)("div",{className:"card",children:(0,d.jsxs)("div",{className:"card__body",style:{textAlign:"center",padding:"3rem"},children:["loading"===e&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"loading-spinner",style:{width:"50px",height:"50px",border:"4px solid #f3f3f3",borderTop:"4px solid var(--ifm-color-primary)",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 1.5rem"}}),(0,d.jsx)("style",{children:"\n                      @keyframes spin {\n                        0% { transform: rotate(0deg); }\n                        100% { transform: rotate(360deg); }\n                      }\n                    "}),(0,d.jsx)("h2",{children:"Verifying..."}),(0,d.jsx)("p",{children:r})]}),"success"===e&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem",color:"var(--ifm-color-success)"},children:"\u2713"}),(0,d.jsx)("h2",{children:"Success!"}),(0,d.jsx)("p",{children:r}),(0,d.jsx)(t.A,{to:"/",className:"button button--primary margin-top--md",children:"Go to Home"})]}),"error"===e&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem",color:"var(--ifm-color-danger)"},children:"\u2717"}),(0,d.jsx)("h2",{children:"Verification Failed"}),(0,d.jsx)("p",{children:r}),(0,d.jsxs)("div",{className:"button-group",style:{marginTop:"1.5rem"},children:[(0,d.jsx)("a",{href:(0,l.fO)("/signin"),className:"button button--primary margin-right--sm",children:"Sign In"}),(0,d.jsx)("a",{href:(0,l.fO)("/signup"),className:"button button--secondary",children:"Sign Up"})]})]})]})})})})})})}},4406:(e,s,r)=>{r.d(s,{fO:()=>i});const i=(e,s)=>{const r=s||("undefined"!=typeof window?window.location.pathname+window.location.search:"/");if(r.includes("/signin")||r.includes("/signup")||r.includes("/auth"))return e;const i=encodeURIComponent(r),n=e.includes("?")?"&":"?";return`${e}${n}returnUrl=${i}`}},5915:(e,s,r)=>{r.d(s,{Og:()=>i});const i=(e,s="/")=>e&&(e=>{try{return!(!e||!e.startsWith("/")||e.includes("://")||e.startsWith("//")||e.includes("/signin")||e.includes("/signout")||e.includes("/signup")||e.includes("/auth"))}catch{return!1}})(e)?e:s}}]);